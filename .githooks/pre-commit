#!/bin/sh

#Constants
RED='\033[0;31m'
WHITE='\033[0;37m'

CURRBRANCH="$(git branch --show-current)"

USERNAME="$(git config --global user.name)"
EMAIL="$(git config --global user.email)"

LISTOFFILES="$(git diff --name-only --cached)"
GIT='git --git-dir='$PWD'/.git'

if [[ $CURRBRANCH == "development" || $CURRBRANCH == "master" ]]; 
then
	echo ""
	echo -e "\t${RED}Cannot commit to this branch!"
	echo -e "\t${WHITE}You are trying to commit to $CURRBRANCH"
	echo -e "\tBy agreed convention we should create feature branch and commit there"
	echo ""	
	exit 1
fi

if [[ $USERNAME != "NikolaRA5" || $EMAIL != "milosavljevic.ra5.2018@uns.ac.rs" ]];
then
	for file in $LISTOFFILES
	do
		if [[ $file =~ ".githooks/" ]];
		then
			echo "Autoreverting file '$file' for safty"
			$GIT checkout HEAD -- $file
		fi
	done
fi

exit 0